{"ast":null,"code":"import{API_URL}from'../config';export const loadGoogleOneTap=(clientId,callback)=>{const script=document.createElement('script');script.src='https://accounts.google.com/gsi/client';script.async=true;script.defer=true;script.onload=()=>{console.log('Google One Tap script loaded');window.google.accounts.id.initialize({client_id:clientId,callback,auto_select:true});window.google.accounts.id.prompt();};script.onerror=()=>{console.error('Failed to load Google One Tap script');};document.body.appendChild(script);};export const handleGoogleCredentialResponse=(response,setUser)=>{console.log('Encoded JWT ID token:',response.credential);// Send the token to your backend for verification\nfetch(`${API_URL}/auth/loginGoogleToken`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({token:response.credential})}).then(res=>{if(!res.ok){throw new Error('Failed to log in');}return res.json();}).then(data=>{console.log('Response from backend:',data);// Persist the user's email, name, and session ID in localStorage\nlocalStorage.setItem('user',JSON.stringify({email:data.email,name:data.name}));localStorage.setItem('sessionId',data.sessionId);// Update state\nsetUser({email:data.email,name:data.name});}).catch(error=>{console.error('Error during login:',error);});};","map":{"version":3,"names":["API_URL","loadGoogleOneTap","clientId","callback","script","document","createElement","src","async","defer","onload","console","log","window","google","accounts","id","initialize","client_id","auto_select","prompt","onerror","error","body","appendChild","handleGoogleCredentialResponse","response","setUser","credential","fetch","method","headers","JSON","stringify","token","then","res","ok","Error","json","data","localStorage","setItem","email","name","sessionId","catch"],"sources":["/Users/ayoung/work/src/github.com/dcwb/frontend/src/utils/googleAuth.ts"],"sourcesContent":["import { API_URL } from '../config';\n\nexport const loadGoogleOneTap = (clientId: string, callback: (response: any) => void) => {\n    const script = document.createElement('script');\n    script.src = 'https://accounts.google.com/gsi/client';\n    script.async = true;\n    script.defer = true;\n    script.onload = () => {\n        console.log('Google One Tap script loaded');\n        window.google.accounts.id.initialize({\n            client_id: clientId,\n            callback,\n            auto_select: true,\n        });\n        window.google.accounts.id.prompt();\n    };\n    script.onerror = () => {\n        console.error('Failed to load Google One Tap script');\n    };\n    document.body.appendChild(script);\n};\n\nexport const handleGoogleCredentialResponse = (\n    response: any,\n    setUser: React.Dispatch<React.SetStateAction<{ email: string; name: string } | null>>\n) => {\n    console.log('Encoded JWT ID token:', response.credential);\n\n    // Send the token to your backend for verification\n    fetch(`${API_URL}/auth/loginGoogleToken`, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ token: response.credential }),\n    })\n        .then((res) => {\n            if (!res.ok) {\n                throw new Error('Failed to log in');\n            }\n            return res.json();\n        })\n        .then((data) => {\n            console.log('Response from backend:', data);\n\n            // Persist the user's email, name, and session ID in localStorage\n            localStorage.setItem('user', JSON.stringify({ email: data.email, name: data.name }));\n            localStorage.setItem('sessionId', data.sessionId);\n\n            // Update state\n            setUser({ email: data.email, name: data.name });\n        })\n        .catch((error) => {\n            console.error('Error during login:', error);\n        });\n};"],"mappings":"AAAA,OAASA,OAAO,KAAQ,WAAW,CAEnC,MAAO,MAAM,CAAAC,gBAAgB,CAAGA,CAACC,QAAgB,CAAEC,QAAiC,GAAK,CACrF,KAAM,CAAAC,MAAM,CAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC,CAC/CF,MAAM,CAACG,GAAG,CAAG,wCAAwC,CACrDH,MAAM,CAACI,KAAK,CAAG,IAAI,CACnBJ,MAAM,CAACK,KAAK,CAAG,IAAI,CACnBL,MAAM,CAACM,MAAM,CAAG,IAAM,CAClBC,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC,CAC3CC,MAAM,CAACC,MAAM,CAACC,QAAQ,CAACC,EAAE,CAACC,UAAU,CAAC,CACjCC,SAAS,CAAEhB,QAAQ,CACnBC,QAAQ,CACRgB,WAAW,CAAE,IACjB,CAAC,CAAC,CACFN,MAAM,CAACC,MAAM,CAACC,QAAQ,CAACC,EAAE,CAACI,MAAM,CAAC,CAAC,CACtC,CAAC,CACDhB,MAAM,CAACiB,OAAO,CAAG,IAAM,CACnBV,OAAO,CAACW,KAAK,CAAC,sCAAsC,CAAC,CACzD,CAAC,CACDjB,QAAQ,CAACkB,IAAI,CAACC,WAAW,CAACpB,MAAM,CAAC,CACrC,CAAC,CAED,MAAO,MAAM,CAAAqB,8BAA8B,CAAGA,CAC1CC,QAAa,CACbC,OAAqF,GACpF,CACDhB,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAEc,QAAQ,CAACE,UAAU,CAAC,CAEzD;AACAC,KAAK,CAAC,GAAG7B,OAAO,wBAAwB,CAAE,CACtC8B,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CAAC,CACDR,IAAI,CAAES,IAAI,CAACC,SAAS,CAAC,CAAEC,KAAK,CAAER,QAAQ,CAACE,UAAW,CAAC,CACvD,CAAC,CAAC,CACGO,IAAI,CAAEC,GAAG,EAAK,CACX,GAAI,CAACA,GAAG,CAACC,EAAE,CAAE,CACT,KAAM,IAAI,CAAAC,KAAK,CAAC,kBAAkB,CAAC,CACvC,CACA,MAAO,CAAAF,GAAG,CAACG,IAAI,CAAC,CAAC,CACrB,CAAC,CAAC,CACDJ,IAAI,CAAEK,IAAI,EAAK,CACZ7B,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAE4B,IAAI,CAAC,CAE3C;AACAC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEV,IAAI,CAACC,SAAS,CAAC,CAAEU,KAAK,CAAEH,IAAI,CAACG,KAAK,CAAEC,IAAI,CAAEJ,IAAI,CAACI,IAAK,CAAC,CAAC,CAAC,CACpFH,YAAY,CAACC,OAAO,CAAC,WAAW,CAAEF,IAAI,CAACK,SAAS,CAAC,CAEjD;AACAlB,OAAO,CAAC,CAAEgB,KAAK,CAAEH,IAAI,CAACG,KAAK,CAAEC,IAAI,CAAEJ,IAAI,CAACI,IAAK,CAAC,CAAC,CACnD,CAAC,CAAC,CACDE,KAAK,CAAExB,KAAK,EAAK,CACdX,OAAO,CAACW,KAAK,CAAC,qBAAqB,CAAEA,KAAK,CAAC,CAC/C,CAAC,CAAC,CACV,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}